/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */

const status = document.getElementById('status');
if (status) {
  status.innerText = 'Loaded TensorFlow.js - version: ' + tf.version.tfjs;
}


// Input feature pairs (House size, Number of Bedrooms)
const INPUTS = [
  [1710, 8], [1262, 6], [1786, 6], [1717, 7], [2198, 9], [1362, 5], [1694, 7], [2090, 7], [1774, 8], [1077, 5], [1040, 5], [2324, 11], [912, 4], [1494, 7], [1253, 5], [854, 5], [1004, 5], [1296, 6], [1114, 6], [1339, 6], [2376, 9], [1108, 6], [1795, 7], [1060, 6], [1060, 6], [1600, 7], [900, 5], [1704, 7], [1600, 6], [520, 4], [1317, 6], [1228, 6], [1234, 7], [1700, 6], [1561, 6], [2452, 9], [1097, 6], [1297, 5], [1057, 5], [1152, 6], [1324, 6], [1328, 5], [884, 5], [938, 5], [1150, 6], [1752, 6], [2149, 6], [1656, 7], [1452, 8], [955, 6], [1470, 6], [1176, 6], [816, 5], [1842, 5], [1360, 6], [1425, 7], [1739, 7], [1720, 7], [2945, 10], [780, 4], [1158, 5], [1111, 6], [1370, 6], [1710, 9], [2034, 8], [2473, 9], [2207, 7], [1479, 7], [747, 4], [2287, 7], [2223, 8], [845, 4], [1718, 7], [1086, 6], [1605, 8], [988, 5], [952, 4], [1285, 6], [1768, 8], [1230, 5], [2142, 8], [1337, 5], [1563, 6], [1065, 6], [1474, 7], [2417, 9], [1560, 6], [1224, 4], [1526, 6], [990, 5], [1040, 4], [1235, 6], [964, 5], [2291, 9], [1786, 7], [1470, 6], [1588, 6], [960, 6], [835, 5], [1225, 6], [1610, 6], [1732, 7], [1535, 8], [1226, 6], [1818, 7], [1992, 9], [1047, 6], [789, 5], [1517, 7], [1844, 7], [1855, 7], [1430, 7], [2696, 10], [2259, 7], [2320, 9], [1458, 5], [1092, 6], [1125, 5], [3222, 11], [1456, 8], [988, 4], [1123, 4], [1080, 5], [1199, 5], [1586, 7], [754, 5], [958, 5], [840, 5], [1348, 6], [1053, 6], [2157, 8], [2054, 7], [1327, 7], [1296, 6], [1721, 7], [1682, 7], [1214, 5], [1959, 9], [1852, 7], [1764, 7], [864, 5], [1734, 7], [1385, 6], [1501, 6], [1728, 10], [1709, 7], [875, 5], [2035, 8], [1080, 6], [1344, 7], [969, 5], [1710, 6], [1993, 8], [1252, 4], [1200, 7], [1096, 5], [1040, 5], [1968, 8], [1947, 8], [2462, 9], [1232, 6], [2668, 10], [1541, 7], [882, 4], [1616, 5], [1355, 6], [1867, 7], [2161, 8], [1720, 7], [1707, 6], [1382, 7], [1656, 7], [1767, 5], [1362, 6], [1651, 7], [2158, 7], [2060, 8], [1920, 8], [2234, 9], [968, 5], [1525, 5], [1802, 9], [1340, 7], [2082, 6], [1252, 5], [3608, 12], [1217, 6], [1656, 8], [1224, 6], [1593, 5], [2727, 10], [1479, 7], [1431, 6], [1709, 7], [864, 5], [1456, 7], [1726, 8], [3112, 8], [2229, 8], [1713, 7], [1121, 5], [1279, 6], [1310, 6], [848, 3], [1284, 5], [1442, 5], [1696, 8], [1100, 6], [2062, 7], [1092, 6], [864, 5], [1212, 6], [1852, 7], [990, 5], [1392, 6], [1236, 6], [1436, 8], [1328, 8], [1954, 8], [1248, 5], [1498, 5], [2267, 8], [1552, 6], [864, 4], [2392, 8], [1302, 6], [2520, 9], [987, 5], [912, 5], [1555, 7], [1194, 6], [2794, 9], [987, 5], [894, 5], [1960, 8], [987, 5], [1414, 6], [1744, 7], [1694, 7], [1487, 7], [1566, 7], [866, 4], [1440, 6], [1217, 6], [2110, 8], [1872, 6], [1928, 9], [1375, 5], [1668, 8], [2144, 7], [1306, 6], [1625, 5], [1640, 6], [1302, 7], [1314, 5], [2291, 8], [1728, 7], [1604, 8], [1792, 7], [882, 4], [1382, 6], [2574, 10], [1212, 6], [1316, 6], [764, 4], [1422, 7], [1511, 8], [2192, 8], [778, 4], [1113, 6], [1939, 8], [1363, 5], [2270, 9], [1632, 6], [816, 5], [1548, 5], [1560, 7], [864, 4], [2121, 8], [2022, 8], [1982, 7], [1262, 5], [1314, 6], [1468, 6], [1575, 5], [1250, 5], [1734, 7], [858, 5], [900, 5], [1396, 7], [1919, 8], [1716, 9], [1716, 8], [2263, 9], [1644, 7], [1003, 6], [1558, 6], [1950, 7], [1743, 7], [1152, 6], [1336, 5], [2452, 9], [1541, 6], [894, 5], [3493, 10], [2000, 8], [2243, 8], [1406, 6], [861, 4], [1944, 8], [1501, 6], [972, 5], [1118, 5], [2036, 8], [1641, 6], [1432, 6], [2353, 10], [1959, 8], [2646, 9], [1472, 6], [2596, 9], [2468, 10], [2730, 8], [1163, 6], [2978, 11], [803, 5], [1719, 6], [1383, 7], [2134, 10], [1192, 6], [1728, 10], [1056, 6], [1629, 7], [1358, 6], [1638, 7], [1786, 7], [1922, 8], [1536, 7], [1621, 8], [1215, 6], [1908, 9], [841, 4], [1040, 6], [1684, 6], [1112, 4], [1577, 6], [958, 5], [1478, 6], [1626, 6], [2728, 10], [1869, 6], [1453, 6], [1111, 5], [720, 5], [1595, 6], [1200, 6], [1167, 6], [1142, 6], [1352, 6], [1924, 7], [912, 5], [1505, 8], [1922, 7], [987, 5], [1574, 6], [1344, 6], [1394, 6], [1431, 6], [1268, 7], [1287, 7], [1664, 7], [1588, 7], [752, 4], [1319, 5], [1928, 8], [904, 4], [914, 5], [2466, 8], [1856, 8], [1800, 7], [1691, 6], [1301, 5], [1797, 8], [784, 5], [1953, 9], [1269, 6], [1184, 8], [1125, 6], [1479, 6], [2332, 9], [1367, 7], [1961, 7], [882, 5], [788, 4], [1034, 5], [1144, 6], [894, 6], [1812, 8], [1077, 6], [1550, 7], [1288, 4], [1310, 6], [672, 4], [2263, 10], [1572, 7], [1620, 8], [1639, 6], [1680, 8], [2172, 9], [2078, 8], [1276, 5], [1056, 5], [1478, 7], [1028, 5], [2097, 9], [1340, 6], [1400, 6], [2624, 10], [1134, 7], [1056, 6], [1344, 8], [1602, 8], [988, 4], [2630, 8], [1196, 6], [1389, 6], [1644, 5], [907, 5], [1208, 6], [1412, 6], [987, 4], [1198, 7], [1365, 6], [1604, 7], [630, 3], [1661, 6], [1118, 6], [904, 4], [694, 4], [1196, 7], [2402, 10], [1440, 8], [1573, 8], [1258, 6], [1908, 8], [1689, 7], [1888, 6], [1886, 10], [1376, 7], [1183, 6], [813, 5], [1533, 5], [1756, 7], [1590, 6], [1728, 8], [1242, 6], [1344, 7], [1663, 6], [1666, 7], [1203, 5], [1935, 8], [1135, 6], [864, 5], [1660, 6], [1040, 5], [1414, 6], [1277, 5], [1644, 7], [1634, 7], [1710, 7], [1502, 4], [1969, 8], [1072, 5], [1976, 7], [1652, 6], [970, 5], [1493, 7], [2643, 9], [1718, 7], [1131, 7], [1850, 8], [1792, 6], [1826, 7], [1216, 5], [999, 6], [1113, 5], [1073, 6], [1484, 7], [2414, 10], [630, 3], [1304, 4], [1578, 5], [1456, 8], [1269, 6], [886, 4], [720, 4], [3228, 10], [1820, 8], [899, 5], [912, 5], [1218, 7], [1768, 7], [1214, 6], [1801, 6], [1322, 6], [1960, 10], [1911, 8], [1218, 4], [1378, 7], [1041, 6], [1363, 6], [1368, 6], [864, 5], [1080, 5], [789, 5], [2020, 9], [2119, 7], [2344, 7], [1796, 7], [2080, 9], [1294, 7], [1244, 6], [1664, 7], [4676, 11], [2398, 8], [1266, 6], [928, 4], [2713, 11], [605, 5], [2515, 9], [1509, 5], [1362, 6], [827, 5], [334, 2], [1414, 6], [1347, 5], [1724, 8], [864, 5], [1159, 7], [1601, 6], [1838, 8], [2285, 8], [1680, 7], [767, 4], [1496, 7], [2183, 9], [1635, 6], [768, 5], [825, 4], [2094, 8], [1069, 4], [928, 5], [1717, 7], [1126, 5], [2046, 8], [1048, 5], [1092, 6], [1336, 7], [1446, 6], [1557, 7], [1392, 5], [1389, 6], [996, 6], [1674, 8], [2295, 9], [1647, 6], [2504, 11], [1535, 7], [2132, 5], [943, 4], [1728, 10], [864, 4], [1692, 6], [1430, 8], [1109, 5], [1216, 6], [1477, 6], [1320, 6], [1392, 5], [1795, 7], [1429, 7], [2042, 8], [816, 5], [2775, 9], [1573, 6], [2028, 7], [838, 5], [860, 4], [1473, 5], [935, 4], [1582, 6], [2296, 10], [816, 4], [848, 4], [924, 5], [1826, 7], [1368, 7], [1402, 7], [1647, 7], [1556, 6], [1904, 8], [1375, 6], [1915, 8], [1200, 4], [1494, 6], [1986, 7], [1040, 6], [2008, 8], [3194, 10], [1029, 5], [2153, 8], [1032, 6], [1872, 7], [1120, 6], [630, 3], [1054, 6], [1509, 7], [832, 4], [1828, 9], [2262, 10], [864, 5], [2614, 9], [980, 6], [1512, 4], [1790, 8], [1116, 5], [1422, 6], [1520, 7], [2080, 9], [1350, 6], [1750, 8], [1554, 6], [1411, 6], [1056, 6], [1056, 4], [3395, 14], [800, 4], [1387, 7], [796, 4], [1567, 7], [1518, 6], [1929, 7], [2704, 9], [1620, 7], [1766, 7], [981, 5], [1048, 7], [1094, 5], [1839, 7], [630, 3], [1665, 7], [1510, 7], [1716, 7], [1469, 7], [2113, 7], [1092, 6], [1053, 5], [1502, 6], [1458, 6], [1486, 7], [1935, 7], [2448, 8], [1392, 5], [1181, 6], [2097, 8], [1936, 7], [2380, 7], [1679, 7], [1437, 6], [1180, 5], [1476, 7], [1369, 6], [1208, 6], [1839, 7], [1136, 5], [1441, 7], [1774, 8], [792, 5], [2046, 7], [988, 5], [923, 5], [1520, 6], [1291, 6], [1668, 7], [1839, 7], [2090, 6], [1761, 7], [1102, 4], [1419, 7], [1362, 6], [848, 3], [4316, 10], [2519, 9], [1073, 4], [1539, 5], [1137, 5], [616, 4], [1148, 6], [894, 5], [1391, 5], [1800, 7], [1164, 6], [2576, 10], [1812, 8], [1484, 7], [1092, 7], [1824, 5], [1324, 6], [1456, 8], [904, 6], [729, 5], [1178, 7], [1228, 5], [960, 6], [1479, 6], [1350, 7], [2554, 8], [1178, 5], [2418, 9], [971, 5], [1742, 5], [848, 3], [864, 5], [1470, 7], [1698, 8], [864, 5], [1680, 5], [1232, 6], [1776, 9], [1208, 5], [1616, 5], [1146, 6], [2031, 8], [1144, 6], [948, 6], [1768, 6], [1040, 6], [1801, 8], [1200, 5], [1728, 7], [1432, 7], [912, 5], [1349, 6], [1464, 6], [1337, 5], [2715, 11], [2256, 8], [2640, 8], [1720, 7], [1529, 9], [1140, 7], [1320, 6], [1494, 6], [2098, 8], [1026, 5], [1471, 6], [1768, 7], [1386, 6], [1501, 6], [2531, 9], [864, 5], [1301, 5], [1547, 7], [2365, 8], [1494, 6], [1506, 6], [1714, 7], [1750, 7], [1836, 8], [3279, 12], [858, 5], [1220, 6], [1117, 6], [912, 5], [1973, 9], [1204, 5], [1614, 7], [894, 5], [2020, 10], [1004, 4], [1253, 6], [1603, 7], [1430, 6], [1110, 4], [1484, 9], [1342, 7], [1652, 7], [2084, 8], [901, 4], [2087, 9], [1145, 5], [1062, 5], [2013, 8], [1496, 7], [1895, 7], [1564, 7], [1285, 7], [773, 4], [3140, 11], [1768, 7], [1688, 8], [1196, 5], [1456, 7], [2822, 12], [1128, 5], [1428, 6], [980, 6], [1576, 6], [1086, 6], [2138, 11], [1309, 5], [848, 4], [1044, 4], [1442, 7], [1250, 7], [1661, 6], [1008, 4], [1689, 7], [1052, 6], [1358, 6], [1640, 6], [936, 4], [1733, 7], [1489, 7], [1489, 7], [2084, 7], [784, 5], [1434, 6], [2126, 7], [1223, 4], [1392, 6], [1200, 4], [1829, 7], [1516, 6], [1144, 6], [1067, 4], [1559, 5], [987, 5], [1099, 6], [1200, 6], [1482, 7], [1539, 8], [1165, 6], [1800, 10], [1416, 7], [1701, 6], [1775, 7], [864, 5], [2358, 10], [1855, 7], [848, 3], [1456, 7], [1646, 7], [1445, 7], [1779, 6], [1040, 6], [1026, 5], [1481, 6], [1370, 6], [2654, 9], [1426, 7], [1039, 6], [1097, 6], [1148, 6], [1372, 6], [1002, 5], [1646, 6], [1120, 5], [2320, 7], [1949, 8], [894, 5], [1682, 7], [910, 5], [1268, 6], [1131, 5], [2610, 11], [1040, 5], [2224, 10], [1155, 6], [864, 6], [1090, 5], [1717, 7], [1593, 7], [2230, 10], [892, 5], [1709, 5], [1712, 8], [1393, 8], [2217, 8], [1505, 6], [924, 6], [1683, 7], [1068, 6], [1383, 6], [1535, 8], [1796, 8], [951, 6], [2240, 12], [2364, 11], [1236, 6], [858, 4], [1306, 5], [1509, 8], [1670, 7], [902, 6], [1063, 6], [1636, 8], [2057, 6], [902, 5], [1484, 8], [2274, 12], [1268, 5], [1015, 6], [2002, 8], [1224, 4], [1092, 6], [480, 4], [1229, 6], [2127, 8], [1414, 6], [1721, 7], [2200, 9], [1316, 6], [1617, 5], [1686, 7], [1126, 6], [2374, 10], [1978, 9], [1788, 7], [2236, 8], [1466, 7], [925, 5], [1905, 8], [1500, 6], [2069, 9], [747, 5], [1200, 5], [1971, 8], [1962, 7], [2403, 10], [1728, 8], [2060, 8], [1440, 8], [1632, 8], [1344, 7], [1869, 7], [1144, 6], [1629, 9], [1776, 7], [1381, 5], [864, 5], [965, 6], [768, 5], [1968, 7], [980, 4], [1958, 8], [1229, 5], [1057, 6], [1337, 6], [1416, 6], [858, 4], [2872, 11], [1548, 7], [1800, 7], [1894, 8], [1484, 8], [1308, 7], [1098, 6], [968, 6], [1095, 6], [1192, 6], [1626, 6], [918, 5], [1428, 6], [2019, 8], [1382, 6], [869, 4], [1241, 4], [894, 5], [1121, 5], [999, 6], [2612, 8], [1266, 6], [2290, 9], [1734, 8], [1164, 5], [1635, 5], [1940, 8], [2030, 8], [1576, 6], [2392, 7], [1742, 8], [1851, 7], [1500, 6], [1718, 7], [1230, 5], [1050, 6], [1442, 6], [1077, 6], [1208, 6], [944, 4], [691, 4], [1574, 7], [1680, 8], [1504, 7], [985, 6], [1657, 7], [1092, 6], [1710, 7], [1522, 7], [1271, 7], [1664, 8], [1502, 7], [1022, 4], [1082, 5], [1665, 6], [1504, 6], [1360, 4], [1472, 7], [1506, 6], [1132, 5], [1220, 6], [1248, 6], [1504, 7], [2898, 10], [882, 5], [1264, 6], [1646, 7], [1376, 6], [1218, 7], [1928, 10], [3082, 12], [2520, 10], [1654, 6], [954, 5], [845, 5], [1620, 6], [2263, 7], [1344, 6], [630, 3], [1803, 8], [1632, 7], [1306, 5], [2329, 10], [2524, 9], [1733, 8], [2868, 11], [990, 5], [1771, 9], [930, 6], [1302, 6], [1316, 6], [1977, 9], [1526, 7], [1989, 7], [1523, 7], [1364, 6], [1850, 7], [2184, 10], [1991, 7], [1338, 6], [894, 6], [2337, 10], [1103, 5], [1154, 6], [2260, 7], [1571, 7], [1611, 7], [2521, 10], [893, 4], [1048, 6], [1556, 8], [1456, 7], [1426, 6], [1240, 5], [1740, 6], [1466, 7], [1096, 6], [848, 3], [990, 5], [1258, 5], [1040, 5], [1459, 6], [1251, 6], [1498, 6], [996, 5], [1092, 6], [1953, 9], [1709, 7], [1247, 4], [1040, 6], [1252, 4], [1694, 7], [1200, 6], [936, 4], [1314, 6], [1355, 7], [1088, 5], [1324, 6], [1601, 7], [438, 3], [950, 5], [1134, 6], [1194, 6], [1302, 6], [2622, 9], [1442, 6], [2021, 9], [1690, 7], [1836, 7], [1658, 8], [1964, 8], [816, 5], [1008, 6], [833, 4], [1734, 7], [1419, 7], [894, 5], [1601, 6], [1040, 6], [1012, 6], [1552, 7], [960, 5], [698, 4], [1482, 7], [1005, 5], [1555, 7], [1530, 7], [1959, 8], [936, 4], [1981, 7], [974, 5], [2210, 8], [2020, 8], [1600, 7], [986, 5], [1252, 6], [1020, 6], [1567, 5], [1167, 6], [952, 4], [1868, 9], [2828, 11], [1006, 5], [924, 5], [1576, 8], [1298, 5], [1564, 7], [1111, 5], [1482, 7], [932, 4], [1466, 6], [1811, 6], [816, 5], [1820, 8], [1437, 6], [1265, 6], [1314, 6], [1580, 7], [1876, 8], [1456, 7], [1640, 7], [894, 5], [1258, 6], [1432, 5], [1502, 7], [1694, 7], [1671, 7], [2108, 7], [3627, 10], [1118, 6], [1261, 6], [1250, 5], [3086, 12], [2345, 9], [2872, 9], [923, 5], [1224, 5], [1343, 7], [1124, 5], [2514, 8], [1652, 5], [4476, 10], [1130, 5], [1572, 5], [1221, 7], [1699, 7], [1624, 5], [1660, 7], [1804, 7], [1622, 7], [1441, 5], [1472, 6], [1224, 5], [1352, 7], [1456, 8], [1863, 9], [1690, 7], [1212, 6], [1382, 6], [864, 5], [1779, 6], [1348, 5], [1630, 6], [1074, 6], [2196, 7], [1056, 5], [1700, 7], [1283, 6], [1660, 8], [1845, 8], [1752, 8], [672, 4], [960, 3], [999, 6], [894, 5], [1902, 8], [1314, 6], [912, 3], [1218, 7], [912, 5], [1211, 5], [1846, 7], [2136, 7], [1490, 8], [1138, 6], [1933, 9], [912, 5], [1702, 7], [1507, 7], [2620, 12], [1190, 6], [1224, 6], [1188, 6], [1964, 7], [1784, 9], [1626, 6], [1948, 8], [1141, 6], [1484, 6], [1768, 8], [1689, 7], [1173, 6], [2076, 7], [1517, 7], [1868, 7], [1553, 6], [1034, 6], [2058, 8], [988, 6], [2110, 8], [1405, 6], [874, 5], [2167, 9], [1656, 7], [1367, 6], [1987, 7], [864, 4], [1166, 5], [1054, 6], [1675, 7], [1050, 5], [1788, 8], [1824, 8], [1337, 5], [1452, 6], [1889, 9], [2018, 10], [3447, 11], [1524, 7], [1524, 4], [1489, 7], [935, 5], [1357, 5], [1250, 8], [1920, 10], [1395, 6], [1724, 7], [2031, 7], [1128, 6], [1573, 6], [1339, 6], [1040, 5], [1824, 8], [2447, 10], [1412, 6], [1328, 6], [1582, 7], [1659, 5], [1970, 8], [1152, 6], [1302, 6], [2372, 11], [1664, 8], [864, 5], [1052, 5], [1128, 6], [1072, 5], [5642, 12], [1246, 6], [1983, 9], [1494, 7], [2526, 8], [1616, 7], [1708, 7], [1652, 6], [1368, 6], [990, 5], [1122, 6], [1294, 6], [1902, 7], [1274, 6], [2810, 9], [2599, 10], [948, 5], [2112, 9], [1630, 8], [1352, 5], [1787, 7], [948, 5], [1478, 6], [720, 4], [1923, 8], [708, 5], [1795, 7], [796, 5], [774, 6], [816, 5], [2792, 8], [1632, 8], [1588, 7], [954, 6], [816, 3], [1360, 6], [1365, 7], [1334, 6], [1656, 8], [693, 4], [1861, 8], [864, 5], [872, 5], [1114, 6], [2169, 7], [1913, 9], [1456, 8], [960, 5], [2156, 9], [1776, 7], [1494, 5], [2358, 8], [2634, 12], [1716, 8], [1176, 4], [3238, 9], [1865, 7], [1920, 8], [892, 5], [1078, 6], [1573, 5], [1980, 8], [2601, 8], [1530, 7], [1738, 7], [1412, 6], [1200, 4], [1674, 7], [1790, 7], [1475, 6], [848, 4], [1668, 8], [1374, 6], [1661, 8], [2097, 8], [2633, 8], [1958, 9], [1571, 7], [790, 4], [1604, 6], [987, 5], [1394, 7], [864, 5], [2117, 7], [1762, 8], [1416, 7], [1258, 6], [1154, 7], [2784, 12], [2526, 10], [1746, 7], [1218, 6], [1525, 6], [1584, 8], [900, 6], [1912, 7], [1500, 6], [2482, 9], [1687, 7], [1513, 8], [1904, 7], [1608, 7], [1158, 5], [1593, 8], [1294, 6], [1464, 6], [1214, 6], [1646, 5], [768, 5], [833, 5], [1363, 6], [2093, 7], [1840, 6], [1668, 6], [1040, 6], [1844, 7], [1848, 8], [1569, 7], [2290, 11], [2450, 7], [1144, 6], [1844, 7], [1416, 7], [1069, 4], [848, 3], [2201, 8], [1344, 6], [1252, 7], [2127, 5], [1558, 6], [804, 4], [1440, 7], [1838, 7], [958, 5], [968, 5], [1792, 8], [1126, 5], [1537, 7], [864, 5], [1932, 7], [1236, 6], [1725, 6], [2555, 11], [848, 3], [2007, 10], [952, 4], [1422, 7], [913, 6], [1188, 6], [2090, 8], [1346, 6], [630, 3], [1792, 8], [1578, 7], [1072, 5], [1140, 6], [1221, 6], [1647, 7], [2073, 7], [2340, 9], [1078, 5], [1256, 6]
];

// Current listed house prices in dollars given their features above (target output values you want to predict).
const HOUSE_PRICES = [208500,181500,223500,140000,250000,143000,307000,200000,129900,118000,129500,345000,144000,279500,157000,132000,149000,90000,159000,139000,325300,139400,230000,129900,154000,256300,134800,306000,207500,68500,40000,149350,179900,165500,277500,309000,145000,153000,109000,82000,160000,170000,144000,130250,141000,319900,239686,249700,113000,127000,177000,114500,110000,385000,130000,180500,172500,196500,438780,124900,158000,101000,202500,140000,219500,317000,180000,226000,80000,225000,244000,129500,185000,144900,107400,91000,135750,127000,136500,110000,193500,153500,245000,126500,168500,260000,174000,164500,85000,123600,109900,98600,163500,133900,204750,185000,214000,94750,83000,128950,205000,178000,118964,198900,169500,250000,100000,115000,115000,190000,136900,180000,383970,217000,259500,176000,139000,155000,320000,163990,180000,100000,136000,153900,181000,84500,128000,87000,155000,150000,226000,244000,150750,220000,180000,174000,143000,171000,230000,231500,115000,260000,166000,204000,125000,130000,105000,222500,141000,115000,122000,372402,190000,235000,125000,79000,109500,269500,254900,320000,162500,412500,220000,103200,152000,127500,190000,325624,183500,228000,128500,215000,239000,163000,184000,243000,211000,172500,501837,100000,177000,200100,120000,200000,127000,475000,173000,135000,153337,286000,315000,184000,192000,130000,127000,148500,311872,235000,104000,274900,140000,171500,112000,149000,110000,180500,143900,141000,277000,145000,98000,186000,252678,156000,161750,134450,210000,107000,311500,167240,204900,200000,179900,97000,386250,112000,290000,106000,125000,192500,148000,403000,94500,128200,216500,89500,185500,194500,318000,113000,262500,110500,79000,120000,205000,241500,137000,140000,180000,277000,76500,235000,173000,158000,145000,230000,207500,220000,231500,97000,176000,276000,151000,130000,73000,175500,185000,179500,120500,148000,266000,241500,290000,139000,124500,205000,201000,141000,415298,192000,228500,185000,207500,244600,179200,164700,159000,88000,122000,153575,233230,135900,131000,235000,167000,142500,152000,239000,175000,158500,157000,267000,205000,149900,295000,305900,225000,89500,82500,360000,165600,132000,119900,375000,178000,188500,260000,270000,260000,187500,342643,354000,301000,126175,242000,87000,324000,145250,214500,78000,119000,139000,284000,207000,192000,228950,377426,214000,202500,155000,202900,82000,87500,266000,85000,140200,151500,157500,154000,437154,318061,190000,95000,105900,140000,177500,173000,134000,130000,280000,156000,145000,198500,118000,190000,147000,159000,165000,132000,162000,172400,134432,125000,123000,219500,61000,148000,340000,394432,179000,127000,187750,213500,76000,240000,192000,81000,125000,191000,426000,119000,215000,106500,100000,109000,129000,123000,169500,67000,241000,245500,164990,108000,258000,168000,150000,115000,177000,280000,339750,60000,145000,222000,115000,228000,181134,149500,239000,126000,142000,206300,215000,113000,315000,139000,135000,275000,109008,195400,175000,85400,79900,122500,181000,81000,212000,116000,119000,90350,110000,555000,118000,162900,172500,210000,127500,190000,199900,119500,120000,110000,280000,204000,210000,188000,175500,98000,256000,161000,110000,263435,155000,62383,188700,124000,178740,167000,146500,250000,187000,212000,190000,148000,440000,251000,132500,208900,380000,297000,89471,326000,374000,155000,164000,132500,147000,156000,175000,160000,86000,115000,133000,172785,155000,91300,34900,430000,184000,130000,120000,113000,226700,140000,289000,147000,124500,215000,208300,161000,124500,164900,202665,129900,134000,96500,402861,158000,265000,211000,234000,106250,150000,159000,184750,315750,176000,132000,446261,86000,200624,175000,128000,107500,39300,178000,107500,188000,111250,158000,272000,315000,248000,213250,133000,179665,229000,210000,129500,125000,263000,140000,112500,255500,108000,284000,113000,141000,108000,175000,234000,121500,170000,108000,185000,268000,128000,325000,214000,316600,135960,142600,120000,224500,170000,139000,118500,145000,164500,146000,131500,181900,253293,118500,325000,133000,369900,130000,137000,143000,79500,185900,451950,138000,140000,110000,319000,114504,194201,217500,151000,275000,141000,220000,151000,221000,205000,152000,225000,359100,118500,313000,148000,261500,147000,75500,137500,183200,105500,314813,305000,67000,240000,135000,168500,165150,160000,139900,153000,135000,168500,124000,209500,82500,139400,144000,200000,60000,93000,85000,264561,274000,226000,345000,152000,370878,143250,98300,155000,155000,84500,205950,108000,191000,135000,350000,88000,145500,149000,97500,167000,197900,402000,110000,137500,423000,230500,129000,193500,168000,137500,173500,103600,165000,257500,140000,148500,87000,109500,372500,128500,143000,159434,173000,285000,221000,207500,227875,148800,392000,194700,141000,755000,335000,108480,141500,176000,89000,123500,138500,196000,312500,140000,361919,140000,213000,55000,302000,254000,179540,109900,52000,102776,189000,129000,130500,165000,159500,157000,341000,128500,275000,143000,124500,135000,320000,120500,222000,194500,110000,103000,236500,187500,222500,131400,108000,163000,93500,239900,179000,190000,132000,142000,179000,175000,180000,299800,236000,265979,260400,98000,96500,162000,217000,275500,156000,172500,212000,158900,179400,290000,127500,100000,215200,337000,270000,264132,196500,160000,216837,538000,134900,102000,107000,114500,395000,162000,221500,142500,144000,135000,176000,175900,187100,165500,128000,161500,139000,233000,107900,187500,160200,146800,269790,225000,194500,171000,143500,110000,485000,175000,200000,109900,189000,582933,118000,227680,135500,223500,159950,106000,181000,144500,55993,157900,116000,224900,137000,271000,155000,224000,183000,93000,225000,139500,232600,385000,109500,189000,185000,147400,166000,151000,237000,167000,139950,128000,153500,100000,144000,130500,140000,157500,174900,141000,153900,171000,213000,133500,240000,187000,131500,215000,164000,158000,170000,127000,147000,174000,152000,250000,189950,131500,152000,132500,250580,148500,248900,129000,169000,236000,109500,200500,116000,133000,66500,303477,132250,350000,148000,136500,157000,187500,178000,118500,100000,328900,145000,135500,268000,149500,122900,172500,154500,165000,118858,140000,106500,142953,611657,135000,110000,153000,180000,240000,125500,128000,255000,250000,131000,174000,154300,143500,88000,145000,173733,75000,35311,135000,238000,176500,201000,145900,169990,193000,207500,175000,285000,176000,236500,222000,201000,117500,320000,190000,242000,79900,184900,253000,239799,244400,150900,214000,150000,143000,137500,124900,143000,270000,192500,197500,129000,119900,133900,172000,127500,145000,124000,132000,185000,155000,116500,272000,155000,239000,214900,178900,160000,135000,37900,140000,135000,173000,99500,182000,167500,165000,85500,199900,110000,139000,178400,336000,159895,255900,126000,125000,117000,395192,195000,197000,348000,168000,187000,173900,337500,121600,136500,185000,91000,206000,82000,86000,232000,136905,181000,149900,163500,88000,240000,102000,135000,100000,165000,85000,119200,227000,203000,187500,160000,213490,176000,194000,87000,191000,287000,112500,167500,293077,105000,118000,160000,197000,310000,230000,119750,84000,315500,287000,97000,80000,155000,173000,196000,262280,278000,139600,556581,145000,115000,84900,176485,200141,165000,144500,255000,180000,185850,248000,335000,220000,213500,81000,90000,110500,154000,328000,178000,167900,151400,135000,135000,154000,91500,159500,194000,219500,170000,138800,155900,126000,145000,133000,192000,160000,187500,147000,83500,252000,137500,197000,92900,160000,136500,146000,129000,176432,127000,170000,128000,157000,60000,119500,135000,159500,106000,325000,179900,274725,181000,280000,188000,205000,129900,134500,117000,318000,184100,130000,140000,133700,118400,212900,112000,118000,163900,115000,174000,259000,215000,140000,135000,93500,117500,239500,169000,102000,119000,94000,196000,144000,139000,197500,424870,80000,80000,149000,180000,174500,116900,143000,124000,149900,230000,120500,201800,218000,179900,230000,235128,185000,146000,224000,129000,108959,194000,233170,245350,173000,235000,625000,171000,163000,171900,200500,239000,285000,119500,115000,154900,93000,250000,392500,745000,120000,186700,104900,95000,262000,195000,189000,168000,174000,125000,165000,158000,176000,219210,144000,178000,148000,116050,197900,117000,213000,153500,271900,107000,200000,140000,290000,189000,164000,113000,145000,134500,125000,112000,229456,80500,91500,115000,134000,143000,137900,184000,145000,214000,147000,367294,127000,190000,132500,101800,142000,130000,138887,175500,195000,142500,265900,224900,248328,170000,465000,230000,178000,186500,169900,129500,119000,244000,171750,130000,294000,165400,127500,301500,99900,190000,151000,181000,128900,161500,180500,181000,183900,122000,378500,381000,144000,260000,185750,137000,177000,139000,137000,162000,197900,237000,68400,227000,180000,150500,139000,169000,132500,143000,190000,278000,281000,180500,119500,107500,162900,115000,138500,155000,140000,160000,154000,225000,177500,290000,232000,130000,325000,202500,138000,147000,179200,335000,203000,302000,333168,119000,206900,295493,208900,275000,111000,156500,72500,190000,82500,147000,55000,79000,130500,256000,176500,227000,132500,100000,125500,125000,167900,135000,52500,200000,128500,123000,155000,228500,177000,155835,108500,262500,283463,215000,122000,200000,171000,134900,410000,235000,170000,110000,149900,177500,315000,189000,260000,104900,156932,144152,216000,193000,127000,144000,232000,105000,165500,274300,466500,250000,239000,91000,117000,83000,167500,58500,237500,157000,112000,105000,125500,250000,136000,377500,131000,235000,124000,123000,163000,246578,281213,160000,137500,138000,137450,120000,193000,193879,282922,105000,275000,133000,112000,125500,215000,230000,140000,90000,257000,207000,175900,122500,340000,124000,223000,179900,127500,136500,274970,144000,142000,271000,140000,119000,182900,192140,143750,64500,186500,160000,174000,120500,394617,149700,197000,191000,149300,310000,121000,179600,129000,157900,240000,112000,92000,136000,287090,145000,84500,185000,175000,210000,266500,142125,147500];

// Ingest 1D input feature arrays as 2D tensors so that you can combine them later.
const INPUTS_TENSOR = tf.tensor2d(INPUTS);

// Output can stay 1 dimensional.
const HOUSE_PRICES_TENSOR = tf.tensor1d(HOUSE_PRICES);

// Function to take a Tensor and normalize values
// based on all values contained in that Tensor.
function normalize(tensor, min, max) {
  const result = tf.tidy(function() {
    // Find the minimum value contained in the Tensor.
    const MIN_VALUE = min || tf.min(tensor, 0);

    // Find the maximum value contained in the Tensor.
    const MAX_VALUE = max || tf.max(tensor, 0);

    // Now calculate subtract the MIN_VALUE from every value in the Tensor
    // And store the results in a new Tensor.
    const TENSOR_SUBTRACT_MIN_VALUE = t.sub(MIN_VALUE);

    // Calculate the range size of possible values.
    const RANGE_SIZE = MAX_VALUE.sub(MIN_VALUE);

    // Return the adjusted values divided by the range size as a new Tensor.
    return TENSOR_SUBTRACT_MIN_VALUE.div(RANGE_SIZE);
  });

  return result, MIN_VALUE, MAX_VALUE;
}


// Normalize all input feature arrays and then dispose of the original non normalized Tensors.

const {INPUTS_TENSOR_NORMALIZED, INPUTS_MAX, INPUTS_MIN} = normalize(INPUTS);

const HOUSE_SIZES_MIN = tf.min(HOUSE_SIZES_TENSOR);
const HOUSE_SIZES_MAX = tf.max(HOUSE_SIZES_TENSOR);
const HOUSE_SIZES_TENSOR_NORMALIZED = normalize(HOUSE_SIZES_TENSOR, HOUSE_SIZES_MIN, HOUSE_SIZES_MAX);
HOUSE_SIZES_TENSOR.dispose();

const HOUSE_BEDROOMS_MIN = tf.min(HOUSE_BEDROOMS_TENSOR);
const HOUSE_BEDROOMS_MAX = tf.max(HOUSE_BEDROOMS_TENSOR);
const HOUSE_BEDROOMS_TENSOR_NORMALIZED = normalize(HOUSE_BEDROOMS_TENSOR);
HOUSE_BEDROOMS_TENSOR.dispose();

// Print normalized Tensors to console to view contents.
console.log('Normalized House Sizes:');
HOUSE_SIZES_TENSOR_NORMALIZED.print();
console.log('Normalized Bedroom Sizes:');
HOUSE_BEDROOMS_TENSOR_NORMALIZED.print();

// Finally merge all the input feature 2D tensors using their 2nd axis (Axis 1 as zero indexed).
// This will combine the input features such that each item is an array of input features.
// For example:
// Feature 1 Tensor: [[1], [2]]
// Feature 2 Tensor: [[3], [4]]
// Returned Merged 2D Tensor: [[1,3], [2,4]]
const AXIS = 1;
const NORMALIZED_INPUT_FEATURES_COMBINED = tf.concat([HOUSE_SIZES_TENSOR_NORMALIZED, HOUSE_BEDROOMS_TENSOR_NORMALIZED], AXIS);
HOUSE_SIZES_TENSOR_NORMALIZED.dispose();
HOUSE_BEDROOMS_TENSOR_NORMALIZED.dispose();
NORMALIZED_INPUT_FEATURES_COMBINED.print();


// Now actually create and define model architecture.
const model = tf.sequential();

// We will use one dense layer with 1 neuron (units) and an input of 
// 2 input feaature values (representing house size and number of rooms)
model.add(tf.layers.dense({inputShape: [2], units: 1}));

model.summary();

train();

async function train() {
  // Choose a learning rate that is suitable for the data we are using.
  const LEARNING_RATE = 0.01;
  
  // Compile the model with the defined learning rate and specify
  // our loss function to use.
  model.compile({
    optimizer: tf.train.sgd(LEARNING_RATE),
    loss: 'meanSquaredError'
  });

  // Finally do the training itself over 500 iterations of the data.
  // As we have so little training data we use batch size of 1.
  // We also set for the data to be shuffled each time we try 
  // and learn from it.
  let results = await model.fit(NORMALIZED_INPUT_FEATURES_COMBINED, HOUSE_PRICES_TENSOR, {
    epochs: 100,
    validationSplit: 0.15, // TODO - define test/val/train split.
    batchSize: 100, 
    shuffle: true
  });
  
  console.log("Average error loss: " + Math.sqrt(results.history.loss[results.history.loss.length - 1]));
  console.log("Average validation error loss: " + Math.sqrt(results.history.val_loss[results.history.val_loss.length - 1]));
  
  NORMALIZED_INPUT_FEATURES_COMBINED.dispose();
  HOUSE_PRICES_TENSOR.dispose();
    
  // Once trained we can evaluate the model.
  evaluate();
}

function evaluate() {
    // Predict answer for a single piece of data.
  const INPUTS = tf.tidy(function() {
    const NEW_SIZE = tf.tensor2d([[844]]);
    const NEW_BEDROOMS = tf.tensor2d([[1]]);

    const NEW_SIZE_NORMALIZED = normalize(NEW_SIZE, HOUSE_SIZES_MIN, HOUSE_SIZES_MAX);
    const NEW_BEDROOMS_NORMALIZED = normalize(NEW_BEDROOMS, HOUSE_BEDROOMS_MIN, HOUSE_BEDROOMS_MAX);

    return NEW_HOUSE_INPUT_TENSOR = tf.concat([NEW_SIZE_NORMALIZED, NEW_BEDROOMS_NORMALIZED], 1);
  });

  let output = model.predict(INPUTS);
  INPUTS.dispose();
  output.print();
  output.dispose();  
  
  // Should show 7 Tensors left in memory incase you want to perform more predictions.
  // 4 Tensors store the min/max values for each of the 2 input features which you will need to normalize new inputs.
  // 3 Tensors make up the model itself that was trained.
  console.log(tf.memory().numTensors);
}
